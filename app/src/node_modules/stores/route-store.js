var Fluxxor = require("fluxxor");
var actions = require("actions");

var RouteStore = Fluxxor.createStore({
  initialize: function (options) {
    this.router         = options.router
    this.currentPath    = options.path
    this.currentParams  = options.params 
    this.currentQuery   = options.query || {} 

    this.bindActions(
      actions.constants.ROUTE.TRANSITION, this.handleRouteTransition
    );
  },

  handleRouteTransition: function (payload) {
    this.currentPath    = payload.path || this.currentPath || '/'
    this.currentParams  = payload.params || this.currentParams
    this.currentQuery   = payload.query || this.currentQuery

    this.router.transitionTo(this.currentPath, this.currentParams, this.currentQuery)
  },

  getCurrentPath: function () {
    return this.currentPath
  },

  getCurrentParams: function () {
    return this.currentParams
  },

  getCurrentQuery: function () {
    return this.currentQuery
  }
});

module.exports = RouteStore;
