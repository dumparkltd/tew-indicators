var Fluxxor = require("fluxxor")
var actions = require("actions")

var _       = require('lodash')

var log     = require('debug')('src:node_modules:stores:chart-store')


var ChartStore = Fluxxor.createStore({
  initialize: function () {

    this.bindActions(
      actions.constants.LINECHART.HIGHLIGHTGROUP, this.highlightGroup,
      actions.constants.LINECHART.UNHIGHLIGHTGROUP, this.unHighlightGroup
    )
    this.highlightGroups = []
    this._ = _
  },
  highlightGroup : function(payload){
    log('highlightGroup',payload)
    if (this._.where(this.highlightGroups, payload.group).length === 0) {
      this.highlightGroups.push(payload.group)
    }
    log('highlightGroups',this.highlightGroups)
    this.emit("change");
  },
  unHighlightGroup : function(payload){
    log('unHighlightGroup',payload)
    if (this._.where(this.highlightGroups, payload.group > 0)) {
      this.highlightGroups = this._.reject(this.highlightGroups,function(g){
        return _.isEqual(g,payload.group)
      })
    }
    log('highlightGroups',this.highlightGroups)
    this.emit("change");
  },
  getHighlightGroups : function(){
    return this.highlightGroups
  }

});

module.exports = ChartStore;
