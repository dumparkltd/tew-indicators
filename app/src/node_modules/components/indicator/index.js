//main
var React       = require('react')
var Fluxxor     = require('fluxxor')

//components
var Table 			= require('react-simple-table')
var FluxMixin   = Fluxxor.FluxMixin(React)

//helpers
// var keys 				= require('lodash.keys')
var capitalize 	= require('capitalize')

var log       = require('debug')('src:components:indicator')

module.exports = React.createClass({

		propTypes : {
			flux: React.PropTypes.object,
			params: React.PropTypes.object
		},

  render: function () {
		log('props', this.props)

		var flux = this.props.flux

		var indicator = flux.stores.indicators.query({ slug: this.props.params.indicatorSlug })[0]
		var data = flux.stores.data.query({ indicator: indicator.id })
		log('data', indicator, data)

		var columns = Object.keys(data[0]).map(function (key) { return capitalize(key) })

    return (
			<div className='indicator'>
				<h2>{indicator.title}</h2>
				<Table className='indicator-table table' columns={columns} data={data}/>
			</div>
    )

  },

})
